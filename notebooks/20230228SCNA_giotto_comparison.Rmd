---
title: "Proximity analysis, 28th Feb 2023"
output: html_notebook
---



```{r}
# Clustering

# PCA and then kmeans

library(tidyverse)
library(factoextra)

data = do.call("rbind", cell_PI)

data$sample <- gsub("\\..*","",rownames(data))
unique(data$sample)

try = data %>% select(label1, label2, PI_value, sample)

try$key = paste(try$label1, try$label2, sep = "_")
try = try %>% select(-c(label1, label2))

try = spread(try, key = key, value = PI_value)

# just form hierarchically clustered heatmap for all samples to get a feeling for the interactions

library(ggplot2)
library(pheatmap)

rownames(try) = try$sample
jpeg(file = "./../../output/giotto_heatmap.jpeg", res = 100)
pheatmap(try[,-1], treeheight_row = 0, treeheight_col = 0)
dev.off()

```



